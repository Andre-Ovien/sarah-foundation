{% extends 'base.html' %}
{% load static %}

{% block body %}
<!-- Page Title -->
<div class="page-title dark-background" data-aos="fade"
     style="background-image: url('{% static "img/page-title-bg.jpg" %}');">
  <div class="container position-relative">
    <h1 id="post-title">Blog Details</h1>
    <p id="post-summary"></p>
    <nav class="breadcrumbs">
      <ol>
        <li><a href="{% url 'home' %}">Home</a></li>
        <li class="current">Blog Details</li>
      </ol>
    </nav>
  </div>
</div>
<!-- End Page Title -->

<div class="container">
  <div class="row">
    <div class="col-lg-8">
      <!-- Blog Details Section -->
      <section id="blog-details" class="blog-details section">
        <div class="container">
          <article class="article">
            <div class="post-img">
              <img id="post-image" src="" alt="" class="img-fluid">
            </div>
            <h2 class="title" id="post-title-2"></h2>
            <div class="meta-top">
              <ul>
                <li><i class="bi bi-person"></i> <span id="post-author"></span></li>
                <li><i class="bi bi-clock"></i> <time id="post-date"></time></li>
              </ul>
            </div>
            <div class="content" id="post-content">
              <!-- Full content will be injected here -->
            </div>
          </article>
        </div>
      </section>
    </div>

    <!-- Sidebar (optional, can copy from template) -->
    <div class="col-lg-4 sidebar">
      <!-- Keep the sidebar widgets if you want -->
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const postId = "{{ post_id }}";  // passed from view

  fetch(`/blog/blog-detail/${postId}/`)
    .then(response => response.json())
    .then(post => {
      document.getElementById("post-title").textContent = post.title;
      document.getElementById("post-summary").textContent = post.content.substring(0, 150) + "...";
      document.getElementById("post-title-2").textContent = post.title;
      document.getElementById("post-author").textContent = post.author;
      document.getElementById("post-date").textContent = new Date(post.publish_date).toLocaleDateString();
      document.getElementById("post-content").innerHTML = `<p>${post.content.replace(/\n/g, '</p><p>')}</p>`;
      document.getElementById("post-image").src = post.image;
    })
    .catch(error => {
      console.error("Error loading post:", error);
    });
});
</script>
{% endblock %}
